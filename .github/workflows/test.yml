name: Simple CPU and RAM Test

on:
  workflow_dispatch:

jobs:
  test:
    runs-on: [self-hosted, lightning-fast]
    steps:
      - name: Start CPU load (30s)
        run: |
          echo "Spinning CPU for 30 seconds..."
          (yes > /dev/null &)  # background CPU load
          CPU_PID=$!
          sleep 30
          kill $CPU_PID
          echo "✅ CPU test complete."

      - name: Allocate ~1GB RAM temporarily
        run: |
          echo "Allocating 1GB of RAM..."
          dd if=/dev/zero of=/tmp/memtest bs=1M count=1024
          rm /tmp/memtest
          echo "✅ RAM test complete."
